---
- name: Install Niri compositor
  ansible.builtin.pacman:
    name:
      - niri
      - xwayland-satellite
    state: present

- name: Install ccache for AUR builds
  ansible.builtin.pacman:
    name: ccache
    state: present

- name: Install DankMaterialShell (binary)
  kewlfft.aur.aur:
    name: dms-shell-bin
    use: "{{ aur_helper }}"
    state: present
  become: true
  become_user: "{{ username }}"

- name: Install XDG portals
  ansible.builtin.pacman:
    name:
      - xdg-desktop-portal-gnome
      - xdg-desktop-portal-gtk
      - xdg-desktop-portal
    state: present

- name: Install Wayland utilities
  ansible.builtin.pacman:
    name: "{{ wayland_utils }}"
    state: present

- name: Install fonts
  ansible.builtin.pacman:
    name: "{{ font_packages }}"
    state: present

- name: Install AUR fonts
  kewlfft.aur.aur:
    name: "{{ aur_font_packages }}"
    use: "{{ aur_helper }}"
    state: present
  become: true
  become_user: "{{ username }}"

- name: Install Ghostty terminal
  ansible.builtin.pacman:
    name:
      - ghostty
      - ghostty-shell-integration
    state: present

- name: Update font cache
  ansible.builtin.command: fc-cache -fv
  changed_when: true
